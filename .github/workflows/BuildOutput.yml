name: Build Static App

on:
  push:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    
    - name: checkout-code
      uses: actions/checkout@v3.0.0

    - name: setup-dotnet
      uses: actions/setup-dotnet@v2
      with:
        dotnet-version: 6.0.x

    - name: build-builder
      run: dotnet build ./_src/Blog.Builder.sln

    - name: publish-builder
      run: dotnet publish ./_src/Blog.Builder.sln --output tmp

    - name: build-output
      run: |
           cd tmp
           dotnet Blog.Builder.dll --workables ../workables --output ../_output

    - name: push-output
      run: |
           cd _output
           git config user.name  ${{ github.actor }}
           git config user.email  ${{ github.actor }}@github.com
           git add .
           git commit --allow-empty -m "Action Build Static Files "
           git push
